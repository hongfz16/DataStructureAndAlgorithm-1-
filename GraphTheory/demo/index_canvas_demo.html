<!DOCTYPE html>
<meta charset="utf-8">
<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

//const d3 = require('d3');

var width = 960,
    height = 500;

var canvas = d3.select("body").append("canvas")
    .attr("width", width)
    .attr("height", height);

var simulation = d3.forceSimulation()
    .force("link", d3.forceLink().id(function(d) { return d.id; }))
    .force("charge", d3.forceManyBody())
    .force("center", d3.forceCenter(width / 2, height / 2));

d3.json("../dataset/filmgraph.json", function(error, graph) {
  if (error) throw error;

  var context = canvas.node().getContext("2d");


  simulation
      .nodes(graph.nodes)
      .on("tick", tick);

  simulation.force("link")
      .links(graph.links);

  //console.log(graph.nodes.length);

  function tick() {
    context.clearRect(0, 0, width, height);

    // draw links
    context.strokeStyle = "rgba(255,255,255,0)";
    context.beginPath();
    graph.links.forEach(function(d) {
      context.moveTo(d.source.x, d.source.y);
      context.lineTo(d.target.x, d.target.y);
    });
    context.stroke();

    // draw nodes
    context.fillStyle = "steelblue";
    context.beginPath();
    graph.nodes.forEach(function(d) {
      context.moveTo(d.x, d.y);
      context.arc(d.x, d.y, 3, 0, 2 * Math.PI);
    });
    context.fill();

  }
});

</script>
